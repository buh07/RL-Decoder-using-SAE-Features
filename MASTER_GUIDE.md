# Master Project Guide

**Start here for complete orientation to the project.**

---

## ğŸš€ Quick Start (5 minutes)

1. **Understand what we did:** Read [PROJECT_STATUS.md](PROJECT_STATUS.md)
2. **See the latest results:** Check [Phase 5.4 Analysis](docs/PHASE5_TASK4_ANALYSIS_REPORT.md)
3. **Set up locally:** Run `./setup_env.sh && source .venv/bin/activate`
4. **Want to contribute?** Check [TODO.md](TODO.md) for active tasks

---

## ğŸ“š Documentation Map

### Essential Reading (Start Here)
- **[README.md](README.md)** - Project overview and quick navigation
- **[PROJECT_STATUS.md](PROJECT_STATUS.md)** - Current status, key results, next steps
- **[TODO.md](TODO.md)** - Active task list

### Technical Documentation (In `docs/`)

#### Current Work
- **[PHASE5_TASK4_ANALYSIS_REPORT.md](docs/PHASE5_TASK4_ANALYSIS_REPORT.md)** â­ LATEST
  - Complete analysis of multi-layer reasoning flow
  - Key findings on architectural differences
  - Implications for reasoning tracking
  - Generated by Phase 5.4 analysis pipeline

- **[PHASE5_TASK4_SPECIFICATION.md](docs/PHASE5_TASK4_SPECIFICATION.md)**
  - Technical design of Phase 5.4 pipeline
  - Architecture diagrams
  - Algorithm descriptions

#### Historical Documentation (In `docs/archived_reports/`)
- Phase 1-5 execution reports
- Previous implementation summaries
- Design specifications
- *(Archived for reference, not active)*

#### Support Documentation
- **[DOCUMENTATION_INDEX.md](docs/DOCUMENTATION_INDEX.md)** - Complete file listing
- **[EXECUTION_START_HERE.md](docs/EXECUTION_START_HERE.md)** - Step-by-step runbook
- **[PROJECT_COMPLETION_SUMMARY.md](docs/PROJECT_COMPLETION_SUMMARY.md)** - Overall progress summary

---

## ğŸ—ï¸ Project Architecture

### Three Layers

```
1. RESEARCH LAYER (What we're studying)
   â””â”€ How language models structure reasoning through depth
   â””â”€ Do different models use different strategies?
   
2. ANALYSIS LAYER (How we study it)
   â””â”€ Train 98 SAEs across all layers
   â””â”€ Measure feature transfer between layers
   â””â”€ Visualize reasoning flow patterns
   
3. IMPLEMENTATION LAYER (Where code lives)
   â”œâ”€ phase5/ - Core implementations
   â”‚  â”œâ”€ phase5_task4_capture_multi_layer.py - Capture activations
   â”‚  â”œâ”€ phase5_task4_train_multilayer_saes.py - Train SAEs
   â”‚  â”œâ”€ phase5_task4_reasoning_flow_analysis.py - Compute transfers
   â”‚  â””â”€ phase5_task4_visualize_reasoning_flow.py - Generate charts
   â”œâ”€ src/ - Core SAE library
   â””â”€ docs/ - This documentation
```

### Data Flow

```
Language Models
    â†“
Activation Capture (98 layers, 4 models)
    â†“
Activation Files (906 MB, organized by layer)
    â†“
SAE Training (98 sparse autoencoders)
    â†“
SAE Checkpoints (8x expansion, 50% sparsity)
    â†“
Transfer Matrix Computation (2,500 layer pairs)
    â†“
Analysis Results (JSON + 13 visualizations)
    â†“
Interactive Reasoning Tracker (NEXT: To be built)
```

---

## ğŸ”¬ Key Findings (Phase 5.4)

| Model | Transfer Quality | Architecture |
|-------|-----------------|--------------|
| **GPT2-medium** | 0.428 | **Universal** - features reused extensively |
| **Gemma-2B** | 0.336 | **Balanced** - moderate specialization |
| **Phi-2** | 0.039 | **Hierarchical** - stage-based transformations |
| **Pythia-1.4B** | 0.046 | **Extreme specialization** - each layer unique |

**Why it matters:** Different models use fundamentally different reasoning strategies despite similar downstream performance. This reveals that there's no "one way" to solve reasoning tasks.

---

## ğŸ“‚ Repository Structure

```
RL-Decoder with SAE Features/
â”‚
â”œâ”€ [ROOT - Essential Files]
â”‚  â”œâ”€ README.md                    # Start here
â”‚  â”œâ”€ PROJECT_STATUS.md            # Current status
â”‚  â”œâ”€ MASTER_GUIDE.md              # This file
â”‚  â”œâ”€ TODO.md                      # Active tasks
â”‚  â””â”€ setup_env.sh                 # Environment setup
â”‚
â”œâ”€ docs/                           # ALL DOCUMENTATION
â”‚  â”œâ”€ DOCUMENTATION_INDEX.md       # Docs index
â”‚  â”œâ”€ PHASE5_TASK4_ANALYSIS_REPORT.md â­ LATEST ANALYSIS
â”‚  â”œâ”€ PHASE5_TASK4_SPECIFICATION.md
â”‚  â”œâ”€ EXECUTION_START_HERE.md
â”‚  â””â”€ archived_reports/            # Historical docs
â”‚
â”œâ”€ phase5/                         # Latest implementation
â”‚  â”œâ”€ phase5_task4_capture_multi_layer.py
â”‚  â”œâ”€ phase5_task4_train_multilayer_saes.py
â”‚  â”œâ”€ phase5_task4_reasoning_flow_analysis.py
â”‚  â”œâ”€ phase5_task4_visualize_reasoning_flow.py
â”‚  â””â”€ ... (earlier phase implementations)
â”‚
â”œâ”€ phase5_results/                 # Latest analysis outputs
â”‚  â””â”€ multilayer_transfer/
â”‚     â”œâ”€ saes/                     # 98 SAE checkpoints
â”‚     â””â”€ reasoning_flow/
â”‚        â”œâ”€ reasoning_flow_analysis.json
â”‚        â””â”€ visualizations/        # 13 PNG heatmaps/charts
â”‚
â”œâ”€ sae_logs/                       # ALL LOGS (organized)
â”‚  â””â”€ phase5_task4_reasoning_flow_*.log
â”‚
â”œâ”€ src/                            # Core library
â”‚  â”œâ”€ sae_architecture.py
â”‚  â”œâ”€ sae_training.py
â”‚  â”œâ”€ activation_capture.py
â”‚  â””â”€ ...
â”‚
â””â”€ phase1/, phase2/, phase3/, phase4/  # Earlier phases
```

---

## ğŸ¯ Current Phase: Phase 5.4 COMPLETE âœ…

### What We Did
1. âœ… Captured activations from ALL 98 layers across 4 models
2. âœ… Fixed layer detection to work with any transformer architecture
3. âœ… Trained 98 SAEs (one per layer) with 8x expansion
4. âœ… Computed transfer matrices showing layer-to-layer feature transfer
5. âœ… Generated visualizations revealing reasoning patterns
6. âœ… Created comprehensive analysis report

### Key Outputs
- **SAE Checkpoints:** `phase5_results/multilayer_transfer/saes/`
- **Analysis Data:** `phase5_results/multilayer_transfer/reasoning_flow/reasoning_flow_analysis.json`
- **Visualizations:** `phase5_results/multilayer_transfer/reasoning_flow/visualizations/` (13 files)
- **Report:** [docs/PHASE5_TASK4_ANALYSIS_REPORT.md](docs/PHASE5_TASK4_ANALYSIS_REPORT.md)

---

## ğŸš€ Next Phase: Phase 6 - Interactive Reasoning Tracking

### What We'll Build
An interactive tool to visualize how reasoning develops through a network:
1. Load an input prompt (e.g., "What is 2+2?")
2. Capture activations at all 98 layers
3. Decode each layer with corresponding SAE
4. Show which features activate at each depth
5. Visualize the reasoning flow

### Why It Matters
Instead of treating models as black boxes, you'll see the actual semantic features the model uses to reason through problems.

---

## ğŸ‘¥ For Different Roles

### If you want to... **Understand what we've done**
â†’ Read [PROJECT_STATUS.md](PROJECT_STATUS.md)

### If you want to... **See the latest analysis**
â†’ Read [docs/PHASE5_TASK4_ANALYSIS_REPORT.md](docs/PHASE5_TASK4_ANALYSIS_REPORT.md)

### If you want to... **Run the code yourself**
â†’ Run `./setup_env.sh` and follow [docs/EXECUTION_START_HERE.md](docs/EXECUTION_START_HERE.md)

### If you want to... **Contribute**
â†’ Check [TODO.md](TODO.md) for active tasks

### If you want to... **Find a specific document**
â†’ Check [docs/DOCUMENTATION_INDEX.md](docs/DOCUMENTATION_INDEX.md)

### If you want to... **Understand code architecture**
â†’ Check comments in `phase5/phase5_task4_*.py` files

---

## âš¡ Quick Commands

```bash
# Activate environment
source setup_env.sh
source .venv/bin/activate

# View latest analysis
cat docs/PHASE5_TASK4_ANALYSIS_REPORT.md

# Check logs
tail -50 sae_logs/phase5_task4_reasoning_flow_*.log

# Count SAE checkpoints
ls phase5_results/multilayer_transfer/saes/*_sae.pt | wc -l

# View visualizations
ls -lh phase5_results/multilayer_transfer/reasoning_flow/visualizations/

# Check computational stats
cat phase5_results/multilayer_transfer/reasoning_flow/visualizations/summary_statistics.txt
```

---

## ğŸ” Troubleshooting

**Q: Where are the visualizations?**
A: `phase5_results/multilayer_transfer/reasoning_flow/visualizations/` - 13 PNG files showing transfer patterns

**Q: Can I export the raw data?**
A: Yes, see `phase5_results/multilayer_transfer/reasoning_flow/reasoning_flow_analysis.json` (JSON format)

**Q: What do the transfer ratios mean?**
A: Higher ratio = better feature transfer from source layer to target layer. Ratio 1.0 = perfect transfer, <0.1 = specialized (doesn't generalize)

**Q: Which model should I focus on?**
A: For reasoning tracking: GPT2-medium (universal features, easier to track). For stage-based analysis: Phi-2 or Pythia (clear layer specialization)

---

## ğŸ“– Full Reading Order

For complete understanding, read in this order:

1. **This guide** (you are here) - 5 min
2. [README.md](README.md) - 5 min
3. [PROJECT_STATUS.md](PROJECT_STATUS.md) - 10 min
4. [docs/PHASE5_TASK4_ANALYSIS_REPORT.md](docs/PHASE5_TASK4_ANALYSIS_REPORT.md) - 30 min
5. [docs/PHASE5_TASK4_SPECIFICATION.md](docs/PHASE5_TASK4_SPECIFICATION.md) - 20 min (for technical depth)

**Total: ~60-70 minutes for complete orientation**

---

## ğŸ“§ Support

If you get stuck:
1. Check [docs/DOCUMENTATION_INDEX.md](docs/DOCUMENTATION_INDEX.md) for relevant documents
2. Review logs in `sae_logs/` for errors
3. Check [TODO.md](TODO.md) for similar tasks
4. Review code comments in `phase5/phase5_task4_*.py`

---

**Last Updated:** February 18, 2026  
**Status:** Phase 5.4 COMPLETE âœ… | Ready for Phase 6

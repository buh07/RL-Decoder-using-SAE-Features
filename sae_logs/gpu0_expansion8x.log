/scratch2/f004ndc/RL-Decoder with SAE Features/src/sae_training.py:158: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = GradScaler() if self.use_amp else None
/scratch2/f004ndc/RL-Decoder with SAE Features/src/sae_training.py:196: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(dtype=self.dtype):
/scratch2/f004ndc/RL-Decoder with SAE Features/src/sae_training.py:223: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  self.scheduler.step()
[Dataset] Found 1 shards in /tmp/gpt2_gsm8k_acts/gsm8k/train
[training] Starting SAE training
  Config: 768D â†’ 6144D
  Device: cuda:0, AMP: True
  Max epochs: 10, Max steps: None

[epoch 0] avg_loss=139.1351, time=2.7s (18 steps)
[epoch 1] avg_loss=101.9192, time=2.2s (18 steps)
[epoch 2] avg_loss=92.2608, time=2.2s (18 steps)
[epoch 3] avg_loss=79.6428, time=2.3s (18 steps)
[epoch 4] avg_loss=65.9064, time=2.2s (18 steps)
[05] step=000100 | loss=52.2485 (recon=52.2472, l1=1.2461, decorr=0.0013) | sparsity=48.99% | lr=1.00e-05 | 55.2ms
[epoch 5] avg_loss=52.7600, time=2.2s (18 steps)
[epoch 6] avg_loss=41.4213, time=2.2s (18 steps)
[epoch 7] avg_loss=32.4659, time=2.2s (18 steps)
[epoch 8] avg_loss=25.8694, time=2.3s (18 steps)
[epoch 9] avg_loss=21.0805, time=2.2s (18 steps)

[training] Complete!
  Total steps: 180
  Total time: 22.7s
  Avg time/step: 126.1ms
[checkpoint] saved to /scratch2/f004ndc/RL-Decoder with SAE Features/checkpoints/sae/sae_768d_final.pt

[done] Training summary:
  total_steps: 180
  total_time_seconds: 22.699063362553716
  avg_time_per_step_ms: 126.10590756974285
  final_loss: 19.494258880615234
  model_saved: /scratch2/f004ndc/RL-Decoder with SAE Features/checkpoints/sae
